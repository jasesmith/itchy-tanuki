!function(o,e){"use strict";angular.module("app",["jamfu","ui.sortable"]).controller("AppController",["$scope","$location","StorageService","UtilityService",function(o,r,n,t){o.headline="Itchy Tanuki",o.icon="circle-o",o.colorHistory=n.get("tanuki-history")||[],o.myColors=n.get("tanuki-colors")||[],o.preferences=n.get("tanuki-preferences")||{useHash:!1,showHistory:!1},o.useHash=o.preferences.useHash,o.showHistory=o.preferences.showHistory,o.sortableOptions={placeholder:"color-brick parking-spot",tolerance:"pointer",stop:function(){var r=e.map(o.myColors,function(o){return o});o.$apply(),n.save("tanuki-colors",r)}};var s=function c(){return!o.$root.$$phase},i=function(r,t){var s=e.find(r,function(o){return o===t});s!==t&&r.push(t),o.colorHistory=e.last(r,90),n.save("tanuki-history",o.colorHistory)};o.clearColorHistory=function(){o.colorHistory=[],n.save("tanuki-history",o.colorHistory)},o.clearSavedColors=function(){o.myColors=[],n.save("tanuki-colors",o.myColors)};var a=function(r){if(r=r?r.toLowerCase():t.randomHexColor().toLowerCase(),i(o.colorHistory,r),o.darker=e.unique([r.darken(10),r.darken(20),r.darken(30),r.darken(40),r.darken(50)]),o.lighter=e.unique([r.lighten(50),r.lighten(40),r.lighten(30),r.lighten(20),r.lighten(10)]),o.color=r,o.brightness=t.colorBrightness(r),o.preferences.useHash&&(window.location.hash=r.replace("#","#/")),s())try{o.$apply()}catch(n){}};o.doIt=function(){a()},o.saveColor=function(r){var t=e.findIndex(o.myColors,function(o){return o===r});t>-1?o.myColors.splice(t,1):o.myColors.push(r),n.save("tanuki-colors",o.myColors)},o.isSaved=function(r){return e.find(o.myColors,function(o){return o===r})},o.loadColor=function(e){o.preferences.useHash?window.location.hash=e.toLowerCase().replace("#","#/"):a(e)},o.setClasses=function(o,e){if(o){var r=t.colorBrightness(o),n=[],s=125>r?"fg-light":"fg-dark";return n.push(s),o===e&&n.push("current"),n.join(" ")}},o.$watch(function(){var o=window.location.hash;return o?o.replace("/",""):""},function(o){a(o)}),o.$watch("useHash",function(e){o.preferences.useHash=e,n.save("tanuki-preferences",o.preferences)}),o.$watch("showHistory",function(e){o.preferences.showHistory=e,n.save("tanuki-preferences",o.preferences)}),$(document).on("keyup",function(o){32===o.keyCode&&a()})}])}(window.angular,window._);